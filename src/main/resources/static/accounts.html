<!DOCTYPE html>

<html>
<head>
<title>SSA-Bank</title>

<style type="text/css">
.menu {
	list-style-type: none;
	margin: 0;
	padding: 0;
	overflow: hidden;
	background-color: #333;
}

.menuitem {
	float: left;
	width: 25%
}

li.menuitem a {
	display: block;
	color: white;
	text-align: center;
	padding: 14px 16px;
	text-decoration: none;
}

li a:hover {
	background-color: blue;
	color: white;
}

.SSAhead {
	display: block;
	margin: 0;
	padding: 0;
	overflow: hidden;
	background-color: #333;
	color: white;
	font-size: 4em;
	width: 100%;
	text-align: center;
}

.list-section {
	display: inherit;
}

.accountslist {
	list-style-type: none;
	list-style: none;
	margin: 0;
	padding: 0;
	overflow: hidden;
	margin: 0;
}

.customerEntry {
	display: block;
	float: left;
	width: 80%;
	background-color: silver;
	text-align: left;
}

.customerEdit {
	display: block;
	background-color: silver;
	text-align: left;
}

li a {
	display: block;
	color: black;
	padding: 14px 16px;
	text-align: left;
	text-decoration: none;
	border: solid black 1px;
	text-decoration: none;
	font-size: large;
}

.customerTable th {
	background-color: silver;
}
</style>

<script src="/jquery-3.1.0.min.js"></script>

<script type="text/javascript">
	//get json

	$(document).ready(function() {
		var customerID = localStorage.getItem('customerID');
		$.getJSON("./customers/" + customerID + "/accounts", accounts);
	});
	
	function accounts(response) {
		var List = document.getElementById("accountsList");
		List.innerHTML = "";

		for (var i = 0; i < response.length; i++) {
			var rowC = '<li>';
			rowC += '<a class="';
			rowC += 'todo';
			rowC += '" href="javascript:;"';
			rowC += 'onclick="displayDetail(';
			rowC += response[i].id;
			rowC += ')">';
			rowC += response[i].type;
			rowC += ',&nbsp;&nbsp;&nbsp;';
			rowC += response[i].balance;
			rowC += '</a>';
			rowC += '</li>';

			$("#accountsList").append(rowC);
		}
		
		//displayList();
		document.getElementById('listSection').style.display = 'block';
	
	}


	function displayList() {

		location.reload(true);
		//document.getElementById('listSection').style.display = 'block';
		//document.getElementById('detailSection').style.display = 'none';
		//document.getElementById('addSection').style.display = 'none';
		//document.getElementById('editSection').style.display = 'none';
		
	}

	function displayDetail(id) {
		document.getElementById('detailSection').style.display = 'block';
		document.getElementById('listSection').style.display = 'none';
		document.getElementById('addSection').style.display = 'none';
		document.getElementById('transactionsSection').style.display = 'none';

		$.getJSON("./customers/" + localStorage.getItem('customerID') + "/accounts/" + id, customerDetail);

		function customerDetail(response) {
			document.getElementById("accid").innerHTML = response.id;
			document.getElementById("acctype").innerHTML = response.type;
			document.getElementById("accbalance").innerHTML = response.balance;
		}

	}
	
	function loadAccounts(){
		window.location.replace("./accounts/" + document.getElementById("cid").innerHTML);
	}
	
	function sendEdit() {
		$.ajax({
		    type: "PUT",
		    url: "./customers/" + document.getElementById("cid").innerHTML,
		    dataType: "json",
		    data: {"firstName": document.getElementById("cfnameE").value, "lastName": document.getElementById("clnameE").value}
		
		})
		.done(toDetail);
	}

	function displayAdd() {

		document.getElementById('addSection').style.display = 'block';
		document.getElementById('listSection').style.display = 'none';
		document.getElementById('detailSection').style.display = 'none';
		document.getElementById('transactionsSection').style.display = 'none';
	}
	
	function sendAdd() {
		$.ajax({
		    type: "POST",
		    url: "./customers/",
		    dataType: "json",
		    data: {"firstName": document.getElementById("cfnameA").value, "lastName": document.getElementById("clnameA").value}
		})
		.done(toDetail);
	}
	
	function toDetail(response){
		displayDetail(response.id);
	}
	
	function backToCustomers(){
		window.location.assign("/ssa-bank/");
	}
	
	function transactions(){
		document.getElementById('transactionsSection').style.display = 'block';
		document.getElementById('addSection').style.display = 'none';
		document.getElementById('listSection').style.display = 'none';
		document.getElementById('detailSection').style.display = 'none';

		
		$.getJSON("./customers/" + localStorage.getItem('customerID') + "/accounts/" + document.getElementById("accid").innerHTML, toTransactions);

		function toTransactions(response) {
			document.getElementById("accidT").innerHTML = response.id;
			document.getElementById("acctypeT").innerHTML = response.type;
			document.getElementById("accbalanceT").innerHTML = response.balance;
		}
	}
	
	function withdraw(){
		document.getElementById('withdrawSection').style.display = 'block';
		document.getElementById('depositSection').style.display = 'none';
		document.getElementById('transactionButtons').style.display = 'none';
	}
	
	function sendWithdraw(){
		$.ajax({
		    type: "PUT",
		    url: "./customers/" + localStorage.getItem('customerID') + "/accounts/" + document.getElementById("accidT").innerHTML + "/withdraw",
		    dataType: "json",
		    data: {"amount": document.getElementById("withdrawValue").value}
		
		})
		.done(toDetail);
	}
	
	function deposit(){
		document.getElementById('depositSection').style.display = 'block';
		document.getElementById('withdrawSection').style.display = 'none';
		document.getElementById('transactionButtons').style.display = 'none';
	}
	
	function sendDeposit(){
		$.ajax({
		    type: "PUT",
		    url: "./customers/" + localStorage.getItem('customerID') + "/accounts/" + document.getElementById("accidT").innerHTML + "/deposit",
		    dataType: "json",
		    data: {"amount": document.getElementById("depositValue").value}
		
		})
		.done(toDetail);
	}	
	
</script>

</head>

<header>
	<section>
		<ul class="menu">
			<li class="menuitem"><a href="javascript:;"
				title="to customers" onclick="backToCustomers()">Customers</a></li>
			<li class="menuitem"><a href="javascript:;"
				title="Customers List" onclick="displayList()">List</a></li>
			<li class="menuitem"><a href="javascript:;" title="Add Customer"
				onclick="displayAdd()">Add</a></li>
		</ul>
		<span class="SSAhead">SSA-Bank</span>
	</section>

</header>

<body>

	<section id="listSection" class="list-section" style="display: none;">

		<ul id="accountsList" class="accountsList">
		</ul>

	</section>

	<section id="addSection" class="add-section" style="display: none;">
		<br> <br>
		First Name: <input id="cfnameA" type="text" value=""></input><br> <br>
			
		Last Name: <input id="clnameA" type="text" value=""></input><br> <br>

		<button id="caddsubmit" onclick="sendAdd()">Submit Add</button> <br> <br>
		
		
		
	</section>

	<section id="detailSection" class="detail-Section"
		style="display: none;">

			Account ID: <span id="accid"></span><br> <br> Account Type: <span
				id="acctype"></span><br> <br> Balance: <span id="accbalance"></span><br>
					<br>
			
			<button id="transactions" onclick="transactions()">Transactions</button> <br> <br>

	</section>

	<section id="transactionsSection" class="transactions-Section" style="display: none;">
	
			Account ID: <span id="accidT"></span><br> <br> Account Type: <span
				id="acctypeT"></span><br> <br> Balance: <span id="accbalanceT"></span><br>
					<br>
					
			<section id="transactionButtons" class="transaction-buttons" style="display: block;">
			<button id="withdraw" onclick="withdraw()">Withdraw</button> <br> <br>
			
			<button id="deposit" onclick="deposit()">Deposit</button> <br> <br>
			</section>
			
			<section id="withdrawSection" class="withdraw-Section" style="display: none;">
			Withdraw Amount: <input id="withdrawValue" type="text" value=""></input><br><br>
			<button id="withdrawSubmit" onclick="sendWithdraw()">Submit Withdraw</button>			
			</section>
			
			<section id="depositSection" class="deposit-Section" style="display: none;">
			Deposit Amount: <input id="depositValue" type="text" value=""></input><br><br>
			<button id="depositSubmit" onclick="sendDeposit()">Submit Deposit</button>			
			</section>
			
			
			

	</section>

</body>

<footer> </footer>

</html>
